<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bergen busstasjon — All departures</title>
  <style>
    :root{ --bg:#fff; --card:#f7f8fb; --text:#0b1220; --muted:#5a6778; --accent:#f97316; --border:#e6eaf0; --bad:#dc2626; }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Inter,Arial;background:var(--bg);color:var(--text)}
    .wrap{max-width:1280px;margin:40px auto;padding:0 18px}
    h1{margin:0 0 10px;font-size:clamp(24px,3vw,38px);font-weight:800}
    .accent{color:var(--accent)}
    .badge{display:inline-flex;gap:.6rem;align-items:center;background:var(--card);border:1px solid var(--border);color:var(--muted);padding:.5rem .9rem;border-radius:999px;font-size:.88rem;font-weight:600;margin-bottom:16px}
    .controls{display:flex;gap:.6rem;flex-wrap:wrap;margin:10px 0 18px}
    .chip{display:inline-flex;align-items:center;gap:.56rem;background:var(--card);border:1px solid var(--border);padding:.5rem .85rem;border-radius:999px;font-weight:600}
    .chip input{appearance:none;width:16px;height:16px;border-radius:6px;border:2px solid var(--accent)}
    .chip input:checked{background:var(--accent)}
    .search{min-width:260px;flex:1 1 280px;background:#fff;border:1px solid var(--border);padding:.65rem .85rem;border-radius:12px}
    #status{color:var(--muted);font-size:.95rem;margin:8px 0}
    .table{background:#fff;border:1px solid var(--border);border-radius:16px;overflow:hidden;box-shadow:0 8px 24px rgba(17,24,39,.06)}
    .thead,.trow{display:grid;grid-template-columns:94px 76px 100px 1fr 180px 110px;align-items:center}
    .thead{background:var(--card);color:var(--muted);font-weight:700;border-bottom:1px solid var(--border)}
    .cell{padding:12px 16px;border-bottom:1px dashed var(--border)}
    .trow:last-child .cell{border-bottom:none}
    .line-pill{display:inline-flex;align-items:center;gap:.45rem;padding:.12rem .52rem;border-radius:8px;border:1px solid var(--accent);color:var(--accent);background:rgba(249,115,22,.08);font-weight:800}
    .footer{display:flex;justify-content:space-between;gap:1rem;align-items:center;color:var(--muted);margin:10px 2px 0}
    .err{color:var(--bad);margin:8px 0;font-weight:700}
    .debug{margin-top:10px;font-size:.88rem;color:#334155;background:#fff;border:1px dashed var(--border);border-radius:12px;padding:8px 10px}
    @media(max-width:880px){ .thead,.trow{grid-template-columns:86px 70px 86px 1fr 140px 96px} }
    @media(max-width:680px){
      .thead{display:none}
      .trow{grid-template-columns:86px 1fr;row-gap:6px}
      .cell{border:none;padding:10px 12px}
      .cell.time{grid-column:1/2;grid-row:1}
      .cell.in{grid-column:1/2;grid-row:2;color:var(--muted)}
      .cell.line{grid-column:2/3;grid-row:1}
      .cell.dest{grid-column:2/3;grid-row:2}
      .cell.stop{grid-column:2/3;grid-row:3}
      .cell.mode{grid-column:2/3;grid-row:4}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Bergen busstasjon — <span class="accent">All departures</span></h1>
    <div class="badge">Uses Cloudflare Worker proxy • Refresh 15s</div>

    <div class="controls">
      <label class="chip"><input id="busToggle" type="checkbox" checked> Bus</label>
      <label class="chip"><input id="tramToggle" type="checkbox" checked> Bybanen</label>
      <input id="exactFilter" class="search" placeholder="Optional exact line filter (comma): e.g. 1, 2, 50E, 600">
    </div>

    <div id="status">Initializing…</div>
    <div id="error" class="err" style="display:none"></div>

    <div class="table">
      <div class="thead">
        <div class="cell">Time</div>
        <div class="cell">In</div>
        <div class="cell">Line</div>
        <div class="cell">Destination</div>
        <div class="cell">Stop</div>
        <div class="cell">Mode</div>
      </div>
      <div id="rows"></div>
    </div>

    <div class="debug" id="debug" style="display:none"></div>

    <div class="footer">
      <div>Source: Entur realtime (via proxy)</div>
      <div>Last update: <span id="ts">—</span></div>
    </div>
  </div>

  <!-- Load the logic from an external file to avoid any inline-script blocking -->
  <script src="app.js" defer></script>
</body>
</html>
